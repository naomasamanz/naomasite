<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>なおまの第２研究所</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="https://naomasite.vercel.app/kenkyu-2">
    <meta name="robots" content="index, follow">
    <meta name="description" content="JavaScriptによるマウス追跡やキーログ保存、アクセス端末の解析などを行う『なおまの第2研究所』。ブラウザの限界に挑む技術デモを公開中。">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "なおまの研究所",
        "item": "https://naomasite.vercel.app/"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "なおまの第２研究所",
        "item": "https://naomasite.vercel.app/kenkyu-2"
      }]
    }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VBTG2MXGGX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-VBTG2MXGGX');
    </script>

    <style>
        body { 
            background: #000; 
            color: #0f0; 
            font-family: 'Consolas', monospace; 
            padding: 0; 
            margin: 0;
            text-align: center; 
        }

        .research-nav {
            display: flex !important;
            justify-content: center !important; 
            align-items: center !important;
            gap: 12px !important;
            background-color: #000000 !important;
            padding: 15px !important;
            position: sticky;
            top: 0;
            z-index: 10000 !important;
            border-bottom: 1px solid #00ff00 !important; 
            overflow-x: auto !important; 
            white-space: nowrap !important; 
            margin-bottom: 30px !important;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 600px) {
            .research-nav {
                justify-content: flex-start !important;
                padding-left: 10px !important;
            }
        }

        .research-nav::-webkit-scrollbar { display: none; }

        .research-nav a {
            background-color: #111111 !important;
            color: #ffffff !important;
            border: 1px solid #ffffff !important;
            padding: 8px 16px !important;
            border-radius: 6px !important;
            text-decoration: none !important;
            font-size: 0.85rem !important;
            font-weight: bold !important;
            flex-shrink: 0 !important;
            margin: 0 !important;
            display: inline-block !important;
            transition: 0.3s !important;
        }

        .research-nav a:hover {
            background-color: #00ff00 !important;
            color: #000000 !important;
            box-shadow: 0 0 15px #00ff00 !important;
        }

        .main-content { padding: 20px; }
        .warning { border: 2px solid #0f0; padding: 20px; display: inline-block; animation: blink 1s infinite; margin-top: 20px; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } }
        
        footer a { color: #fff; text-decoration: none; border: 1px solid #fff; padding: 5px 10px; margin-top: 40px; display: inline-block; }
    </style>
</head>
<body>
    
    <nav class="research-nav">
        <a href="index.html">トップページ</a>
        <a href="info.html">お知らせ</a>
        <a href="kenkyu-2.html">第２研究所</a>
        <a href="privacy.html">規約・ポリシー</a>
        <a href="contact.html">お問い合わせ</a>
    </nav>
    
    <div class="main-content">
        <h1>ここは第２研究所です。</h1>
        
        <div id="data-prison" style="font-family: 'Consolas', monospace; color: #0f0; background: #000; padding: 20px; border: 1px solid #0f0;">
            <h2>リアルタイムモニター</h2>
            <p>マウス座標: <span id="mouse-pos">X: 0, Y: 0</span></p>
            <p>スクロール量: <span id="scroll-val">0</span> px</p>
            <p>滞在秒数: <span id="timer-val">0</span> sec</p>
            <p>クリック回数: <span id="click-count">0</span></p>
            <p>アクセス端末: <span id="user-device" style="color: #0f0; font-weight: bold;"></span></p>
            <p>IPアドレス: <span id="user-ip" style="color: #0f0; font-weight: bold;">SCANNING...</span></p>
            <p>最後に押されたキー: <span id="last-key" style="color: #ff0; font-weight: bold;">NONE</span></p>
            <p>思考の蓄積（ログ）: <br>
                <span id="key-history" style="font-size: 0.8em; color: #888; word-wrap: break-word;">...waiting for input</span>
            </p>
        </div>

        <footer>
            <a href="https://naomasite.vercel.app/">研究所トップページへ戻る</a>
        </footer>
    </div>

    <script>
        let clicks = 0;
        let seconds = 0;

        setInterval(() => {
            seconds++;
            document.getElementById('timer-val').innerText = seconds;
        }, 1000);

        window.addEventListener('mousemove', (e) => {
            document.getElementById('mouse-pos').innerText = `X: ${e.clientX}, Y: ${e.clientY}`;
        });

        window.addEventListener('scroll', () => {
            document.getElementById('scroll-val').innerText = window.scrollY;
        });

        window.addEventListener('click', () => {
            clicks++;
            document.getElementById('click-count').innerText = clicks;
        });

        let savedLog = localStorage.getItem('naoma_log') || "";
        const historyDisplay = document.getElementById('key-history');
        historyDisplay.innerText = savedLog || "Waiting for your thoughts...";

        window.addEventListener('keydown', (e) => {
            const keyName = (e.key === " ") ? "Space" : e.key;
            savedLog += keyName + " ";
            if (savedLog.length > 1000) savedLog = savedLog.slice(-1000);
            
            try {
                localStorage.setItem('naoma_log', savedLog);
            } catch (err) {
                console.error("記憶容量が限界です。", err);
            }

            historyDisplay.innerText = savedLog;
            document.getElementById('last-key').innerText = keyName;
        });

        let secretBuffer = "";
        window.addEventListener('keydown', (e) => {
            secretBuffer += e.key.toLowerCase();
            if (secretBuffer.length > 10) secretBuffer = secretBuffer.slice(-10);

            if (secretBuffer === "naomanaoma") {
                localStorage.removeItem('naoma_log');
                savedLog = "";
                secretBuffer = "";
                document.getElementById('key-history').innerText = "SYSTEM REBOOTED: All memories have been purged.";
                document.getElementById('last-key').innerText = "PURGED";
                
                document.body.style.transition = "background 0.1s";
                document.body.style.backgroundColor = "#ffffff";
                setTimeout(() => { document.body.style.backgroundColor = "#000000"; }, 100);
            }
        });

        const observer = setInterval(() => {
            const deviceDisp = document.getElementById('user-device');
            if (deviceDisp) {
                const ua = navigator.userAgent;
                let deviceType = "UNKNOWN";
                if (ua.includes('Windows')) deviceType = "Windows";
                else if (/Android|iPhone|iPad|iPod/i.test(ua)) deviceType = "Mobile / Tablet";
                else if (ua.includes('Macintosh')) deviceType = "Mac";
                else deviceType = "External Device";
                
                deviceDisp.innerText = deviceType;
                clearInterval(observer);
            }
        }, 100);

fetch('https://api.ipify.org?format=json')
    .then(response => response.json())
    .then(data => {
        const ipDisp = document.getElementById('user-ip');
        if (ipDisp) {
            ipDisp.innerText = data.ip;
            console.log("ターゲットのIPを補足: " + data.ip);
        }
    })
    .catch(err => {
        document.getElementById('user-ip').innerText = "FAILED TO RETRIEVE";
    });
    </script>
</body>
</html>
